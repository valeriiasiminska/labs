def line_pairs_generator():
    """
    Генератор, який читає файл text100.txt пострічково
    і для кожного рядка повертає його номер та 3 найчастіші пари букв.
    """

    # Відкриваємо файл "text100.txt" у режимі читання ("r") з кодуванням UTF-8
    # f — це змінна-файловий об'єкт, через яку ми читаємо рядки з файлу
    f = open("text100.txt", "r", encoding="utf-8")

    # Лічильник номерів рядків. Починаємо з 0, перед першим рядком будемо +1
    line_number = 0

    # Проходимо по файлу рядок за рядком
    for line in f:
        # Збільшуємо номер рядка на 1 (тепер це номер поточного рядка)
        line_number += 1

        # strip() — прибирає зайві пробіли/переноси з початку і кінця рядка
        # split() — розбиває рядок на слова по пробілах
        # words — список слів у поточному рядку
        words = line.strip().split()

        # pairs — словник, у якому ключ — пара букв (рядок довжини 2),
        # а значення — скільки разів ця пара зустрілась у цьому рядку
        pairs = {}

        # ---- Рахуємо пари всередині кожного слова ----
        # Перебираємо всі слова з поточного рядка
        for w in words:
            # Перетворюємо слово в нижній регістр, щоб 'А' і 'а' вважати однаковими
            w = w.lower()

            # clean — сюди будемо записувати тільки букви з слова (без цифр, знаків, тощо)
            clean = ""

            # Перебираємо кожен символ слова
            for ch in w:
                # isalpha() повертає True, якщо символ — літера (а-я, a-z, інші алфавіти)
                if ch.isalpha():
                    # Додаємо букву до "чистого" слова
                    clean += ch

            # Тепер у clean знаходиться слово тільки з букв, без сміття
            # Рахуємо пари сусідніх букв всередині clean
            # наприклад, "привіт" -> "пр", "ри", "ив", "ві", "іт"
            for i in range(len(clean) - 1):
                # Беремо пару з двох сусідніх символів: i-й і (i+1)-й
                pair = clean[i] + clean[i + 1]

                # Якщо такої пари ще немає в словнику pairs — додаємо зі значенням 1
                if pair not in pairs:
                    pairs[pair] = 1
                else:
                    # Інакше збільшуємо лічильник цієї пари на 1
                    pairs[pair] += 1

        # ---- Вибираємо 3 найбільш часті пари ----
        # pairs.items() -> список кортежів (пара, кількість): ('пр', 5), ('ри', 2), ...
        # key=lambda x: x[1] — сортуємо за другим елементом кортежу, тобто за кількістю
        # reverse=True — сортуємо в порядку спадання (від більшого до меншого)
        # [:3] — беремо тільки перші 3 елементи після сортування (топ-3 пари)
        top3 = sorted(pairs.items(), key=lambda x: x[1], reverse=True)[:3]

        # Перетворюємо список кортежів top3 назад у словник
        # Наприклад: [('пр', 5), ('ра', 3), ('ан', 2)] -> {'пр': 5, 'ра': 3, 'ан': 2}
        top3_dict = {p: c for p, c in top3}

        # Генератор "yield" повертає результат назовні, але не завершає функцію.
        # Тут ми повертаємо кортеж:
        # line_number — номер рядка
        # top3_dict — словник з 3 найчастішими парами букв у цьому рядку
        yield line_number, top3_dict

    # Після завершення циклу по файлу — закриваємо файл
    f.close()



# --------------- ОСНОВНА ЧАСТИНА ПРОГРАМИ -----------------

# Викликаємо генератор line_pairs_generator().
# Він буде поступово повертати (num, top_pairs) для кожного рядка.
for num, top_pairs in line_pairs_generator():
    # num — номер рядка (line_number з генератора)
    # top_pairs — словник вигляду {'пр': 5, 'ра': 3, 'ан': 2}
    # Виводимо номер рядка та його три найчастіші пари букв
    print("Рядок", num, "---", top_pairs)
